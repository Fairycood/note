# 列表渲染

## v-for（数组）

* 支持两个参数(item,index) in items。item是数组中的每一个项目，index是项目对应的索引

## v-for(对象)

* 支持三个参数(item,name,index) in items。 item是对象中的每一个属性，name是属性的键名，index是索引

## v-for可以用来遍历数字

* 用来生成相同类型的连续数字的class类名还是挺香的

## 类名(DOM属性)中使用模板字符串

```js
<li :class="`list_0${i}`" v-for="(item,index) in lists" :key="index">
    {{item}}
</li>
```

## 维护状态

* key值的作用是为了更加高效的更新虚拟DOM。
* key值最好要使用的是item.id，与列表一一对应并且不会重复，唯一标识。(可以使用uuid或者自定义个每次调用都会递增的函数)
* key属性是vnode的标记，在diff过程中可以提高diff的效率
* 列表循环的时候不使用key值的时候，会采用就地复用的策略。加了key值会根据标识来更新DOM。

* key被应用在组件上时，当key改变的时候Vue认为一个新的元素产生了，从而会新插入一个元素来代替原有的元素。会触发组件的生命周期钩子函数。
* 在切换的时候如果两个元素拥有很类似的结构，那么Vue会复用DOM结构。需要加入key值来区分这两个DOM。

## Vue的虚拟DOM

### js操作真实DOM的代价

* 一次操作需要更新10个DOM节点。原生的js会操作DOM十次。最多可能绘制十次页面。浪费性能。

### 虚拟DOM

#### Vue中的虚拟DOM

* 一次操作需要更新十个DOM。页面的更新先全部反映在JS对象(虚拟DOM)中，然后通过diff算法对新旧两个虚拟DOM进行对比，把这次更新产生的差异保存到本地的一个js对象中。最终根据差异对象来更改(patch打补丁)原来的真实的DOM结构。

### 用js模拟DOM树，渲染用js表示的DOM对象

* 使用js的对象来表示DOM节点，使用对象的属性记录节点的类型，属性，子节点等。
* 通过一个render函数来遍历js的对象，递归的绘制出这个DOM节点及其它的子节点。

#### diff算法

* diff算法用来比较两个Virtual DOM树的差异，diff算法只会比较同一个层级的元素。
* 采用深度优先算法

## v-for和v-if一起使用

* 不推荐在同一元素上使用v-for和v-if
* 当处于同一节点时，v-for的优先级别比v-if的优先级别高，可以实现为部分项渲染节点。(比如说只有那些user.money > 5000的人才会被渲染的话，推荐使用一下计算属性把user数组进行筛选)
* 如果想要依照条件进行渲染时，把v-if放在外层(如果某一个条件为真的话，才加载这个列表)